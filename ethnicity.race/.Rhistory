by = 'ID'),
by = 'ID'),
by = 'ID') %>%
separate(ID, c('State', 'Race'),sep = ", ") %>%
rename('2011' = x.x.x.x.x,
'2012' = x.y,
'2013' = x.x.x.x,
'2014' = x.y.y,
'2015' = x.x.x,
'2016' = x.y.y.y,
'2017' = x.x,
'2018' = x.y.y.y.y
)
View(joined_pop_est)
sum_by_demo <- function(col, year){
#returns
col <- enquo(col)
year <- enquo(year)
df <-
census_est %>%
group_by(NAME) %>%
summarise(x = sum(!!col)) %>%
mutate(ID = paste(NAME)) %>%
ungroup() %>%
select(-NAME)
return(df)
}
#nested join group in combo with the above function
joined_pop_est <- inner_join(sum_by_demo(POPESTIMATE2011, 2011),
inner_join(sum_by_demo(POPESTIMATE2012, 2012),
inner_join(sum_by_demo(POPESTIMATE2013, 2013),
inner_join(sum_by_demo(POPESTIMATE2014, 2014),
inner_join(sum_by_demo(POPESTIMATE2015, 2015),
inner_join(sum_by_demo(POPESTIMATE2016, 2016),
inner_join(sum_by_demo(POPESTIMATE2017, 2017),
sum_by_demo(POPESTIMATE2018, 2018),
by = 'ID'),
by = 'ID'),
by = 'ID'),
by = 'ID'),
by = 'ID'),
by = 'ID'),
by = 'ID') %>%
separate(ID, c('State', 'Race'),sep = ", ") %>%
rename('2011' = x.x.x.x.x,
'2012' = x.y,
'2013' = x.x.x.x,
'2014' = x.y.y,
'2015' = x.x.x,
'2016' = x.y.y.y,
'2017' = x.x,
'2018' = x.y.y.y.y
)
View(joined_pop_est)
#nested join group in combo with the above function
joined_pop_est <- inner_join(sum_by_demo(POPESTIMATE2011, 2011),
inner_join(sum_by_demo(POPESTIMATE2012, 2012),
inner_join(sum_by_demo(POPESTIMATE2013, 2013),
inner_join(sum_by_demo(POPESTIMATE2014, 2014),
inner_join(sum_by_demo(POPESTIMATE2015, 2015),
inner_join(sum_by_demo(POPESTIMATE2016, 2016),
inner_join(sum_by_demo(POPESTIMATE2017, 2017),
sum_by_demo(POPESTIMATE2018, 2018),
by = 'ID'),
by = 'ID'),
by = 'ID'),
by = 'ID'),
by = 'ID'),
by = 'ID'),
by = 'ID') %>%
rename(State = ID) %>%
rename('2011' = x.x.x.x.x,
'2012' = x.y,
'2013' = x.x.x.x,
'2014' = x.y.y,
'2015' = x.x.x,
'2016' = x.y.y.y,
'2017' = x.x,
'2018' = x.y.y.y.y
)
filter_demo_pop<- function(df, race, year){
year <- enquo(year)
df <-
df %>%
filter(Race == race) %>%
select(State, !!year) %>%
mutate(Year = as.numeric(!!year)) %>%
rename(pop_est = !!year)
return(df)
}
df <-
df %>%
select(State, !!year) %>%
mutate(Year = as.numeric(!!year)) %>%
rename(pop_est = !!year)
filter_demo_pop<- function(df, year){
year <- enquo(year)
df <-
df %>%
select(State, !!year) %>%
mutate(Year = as.numeric(!!year)) %>%
rename(pop_est = !!year)
return(df)
}
black_pop_est <- rbind(filter_demo_pop(joined_pop_est, '2011' ),
filter_demo_pop(joined_pop_est, '2012' ),
filter_demo_pop(joined_pop_est, '2013' ),
filter_demo_pop(joined_pop_est, '2014' ),
filter_demo_pop(joined_pop_est, '2015' ),
filter_demo_pop(joined_pop_est, '2016' ),
filter_demo_pop(joined_pop_est, '2017' ),
filter_demo_pop(joined_pop_est, '2018' )) %>%
rename(hisp_est = pop_est) %>%
mutate(ID = paste(State, Year, sep = ', ')) %>%
select(hisp_est, ID)
View(black_pop_est)
hisp_pop_est <- rbind(filter_demo_pop(joined_pop_est, '2011' ),
filter_demo_pop(joined_pop_est, '2012' ),
filter_demo_pop(joined_pop_est, '2013' ),
filter_demo_pop(joined_pop_est, '2014' ),
filter_demo_pop(joined_pop_est, '2015' ),
filter_demo_pop(joined_pop_est, '2016' ),
filter_demo_pop(joined_pop_est, '2017' ),
filter_demo_pop(joined_pop_est, '2018' )) %>%
rename(hisp_est = pop_est) %>%
mutate(ID = paste(State, Year, sep = ', ')) %>%
select(hisp_est, ID)
combined_data <-
combined_data %>%
mutate(ID = paste(State, Year, sep = ', '))
hisp_data <-
inner_join(combined_data, hisp_pop_est, by = 'ID') %>%
mutate(hisp_per_pop = round(hisp_pop_est / pop, 4)) %>%
select(ID, hisp_per_pop)
hisp_pop_est <- rbind(filter_demo_pop(joined_pop_est, '2011' ),
filter_demo_pop(joined_pop_est, '2012' ),
filter_demo_pop(joined_pop_est, '2013' ),
filter_demo_pop(joined_pop_est, '2014' ),
filter_demo_pop(joined_pop_est, '2015' ),
filter_demo_pop(joined_pop_est, '2016' ),
filter_demo_pop(joined_pop_est, '2017' ),
filter_demo_pop(joined_pop_est, '2018' )) %>%
rename(hisp_est = pop_est) %>%
mutate(ID = paste(State, Year, sep = ', ')) %>%
select(hisp_est, ID)
combined_data <-
combined_data %>%
mutate(ID = paste(State, Year, sep = ', '))
hisp_data <-
inner_join(combined_data, hisp_pop_est, by = 'ID') %>%
mutate(hisp_per_pop = round(hisp_pop_est / pop, 4)) %>%
select(ID, hisp_per_pop)
hisp_data <-
inner_join(combined_data, hisp_pop_est, by = 'ID') %>%
mutate(hisp_per_pop = round(hisp_est / pop, 4)) %>%
select(ID, hisp_per_pop)
View(hisp_data)
census_est <-
read.csv('sc-est2018-alldata6.csv') %>%
#where sex = 0 is both, and origin = 1 is non-hispanic and 2 is hispanic
filter(SEX == 0, ORIGIN == 0)
sum_by_demo <- function(col, year){
#returns
col <- enquo(col)
year <- enquo(year)
df <-
census_est %>%
group_by(NAME) %>%
summarise(x = sum(!!col)) %>%
mutate(ID = paste(NAME)) %>%
ungroup() %>%
select(-NAME)
return(df)
}
#nested join group in combo with the above function
joined_pop_est <- inner_join(sum_by_demo(POPESTIMATE2011, 2011),
inner_join(sum_by_demo(POPESTIMATE2012, 2012),
inner_join(sum_by_demo(POPESTIMATE2013, 2013),
inner_join(sum_by_demo(POPESTIMATE2014, 2014),
inner_join(sum_by_demo(POPESTIMATE2015, 2015),
inner_join(sum_by_demo(POPESTIMATE2016, 2016),
inner_join(sum_by_demo(POPESTIMATE2017, 2017),
sum_by_demo(POPESTIMATE2018, 2018),
by = 'ID'),
by = 'ID'),
by = 'ID'),
by = 'ID'),
by = 'ID'),
by = 'ID'),
by = 'ID') %>%
rename(State = ID) %>%
rename('2011' = x.x.x.x.x,
'2012' = x.y,
'2013' = x.x.x.x,
'2014' = x.y.y,
'2015' = x.x.x,
'2016' = x.y.y.y,
'2017' = x.x,
'2018' = x.y.y.y.y
)
filter_demo_pop<- function(df, year){
year <- enquo(year)
df <-
df %>%
select(State, !!year) %>%
mutate(Year = as.numeric(!!year)) %>%
rename(pop_est = !!year)
return(df)
}
hisp_pop_est <- rbind(filter_demo_pop(joined_pop_est, '2011' ),
filter_demo_pop(joined_pop_est, '2012' ),
filter_demo_pop(joined_pop_est, '2013' ),
filter_demo_pop(joined_pop_est, '2014' ),
filter_demo_pop(joined_pop_est, '2015' ),
filter_demo_pop(joined_pop_est, '2016' ),
filter_demo_pop(joined_pop_est, '2017' ),
filter_demo_pop(joined_pop_est, '2018' )) %>%
rename(hisp_est = pop_est) %>%
mutate(ID = paste(State, Year, sep = ', ')) %>%
select(hisp_est, ID)
combined_data <-
combined_data %>%
mutate(ID = paste(State, Year, sep = ', '))
hisp_data <-
inner_join(combined_data, hisp_pop_est, by = 'ID') %>%
mutate(hisp_per_pop = round(hisp_est / pop, 4)) %>%
select(ID, hisp_per_pop)
census_est <-
read.csv('sc-est2018-alldata6.csv') %>%
#where sex = 0 is both, and origin = 1 is non-hispanic and 2 is hispanic
filter(SEX == 0, ORIGIN == 1)
sum_by_demo <- function(col, year){
#returns
col <- enquo(col)
year <- enquo(year)
df <-
census_est %>%
group_by(NAME) %>%
summarise(x = sum(!!col)) %>%
mutate(ID = paste(NAME)) %>%
ungroup() %>%
select(-NAME)
return(df)
}
#nested join group in combo with the above function
joined_pop_est <- inner_join(sum_by_demo(POPESTIMATE2011, 2011),
inner_join(sum_by_demo(POPESTIMATE2012, 2012),
inner_join(sum_by_demo(POPESTIMATE2013, 2013),
inner_join(sum_by_demo(POPESTIMATE2014, 2014),
inner_join(sum_by_demo(POPESTIMATE2015, 2015),
inner_join(sum_by_demo(POPESTIMATE2016, 2016),
inner_join(sum_by_demo(POPESTIMATE2017, 2017),
sum_by_demo(POPESTIMATE2018, 2018),
by = 'ID'),
by = 'ID'),
by = 'ID'),
by = 'ID'),
by = 'ID'),
by = 'ID'),
by = 'ID') %>%
rename(State = ID) %>%
rename('2011' = x.x.x.x.x,
'2012' = x.y,
'2013' = x.x.x.x,
'2014' = x.y.y,
'2015' = x.x.x,
'2016' = x.y.y.y,
'2017' = x.x,
'2018' = x.y.y.y.y
)
filter_demo_pop<- function(df, year){
year <- enquo(year)
df <-
df %>%
select(State, !!year) %>%
mutate(Year = as.numeric(!!year)) %>%
rename(pop_est = !!year)
return(df)
}
hisp_pop_est <- rbind(filter_demo_pop(joined_pop_est, '2011' ),
filter_demo_pop(joined_pop_est, '2012' ),
filter_demo_pop(joined_pop_est, '2013' ),
filter_demo_pop(joined_pop_est, '2014' ),
filter_demo_pop(joined_pop_est, '2015' ),
filter_demo_pop(joined_pop_est, '2016' ),
filter_demo_pop(joined_pop_est, '2017' ),
filter_demo_pop(joined_pop_est, '2018' )) %>%
rename(hisp_est = pop_est) %>%
mutate(ID = paste(State, Year, sep = ', ')) %>%
select(hisp_est, ID)
combined_data <-
combined_data %>%
mutate(ID = paste(State, Year, sep = ', '))
hisp_data <-
inner_join(combined_data, hisp_pop_est, by = 'ID') %>%
mutate(hisp_per_pop = round(hisp_est / pop, 4)) %>%
select(ID, hisp_per_pop)
census_est <-
read.csv('sc-est2018-alldata6.csv') %>%
#where sex = 0 is both, and origin = 1 is non-hispanic and 2 is hispanic
filter(SEX == 0, ORIGIN == 2)
sum_by_demo <- function(col, year){
#returns
col <- enquo(col)
year <- enquo(year)
df <-
census_est %>%
group_by(NAME) %>%
summarise(x = sum(!!col)) %>%
mutate(ID = paste(NAME)) %>%
ungroup() %>%
select(-NAME)
return(df)
}
#nested join group in combo with the above function
joined_pop_est <- inner_join(sum_by_demo(POPESTIMATE2011, 2011),
inner_join(sum_by_demo(POPESTIMATE2012, 2012),
inner_join(sum_by_demo(POPESTIMATE2013, 2013),
inner_join(sum_by_demo(POPESTIMATE2014, 2014),
inner_join(sum_by_demo(POPESTIMATE2015, 2015),
inner_join(sum_by_demo(POPESTIMATE2016, 2016),
inner_join(sum_by_demo(POPESTIMATE2017, 2017),
sum_by_demo(POPESTIMATE2018, 2018),
by = 'ID'),
by = 'ID'),
by = 'ID'),
by = 'ID'),
by = 'ID'),
by = 'ID'),
by = 'ID') %>%
rename(State = ID) %>%
rename('2011' = x.x.x.x.x,
'2012' = x.y,
'2013' = x.x.x.x,
'2014' = x.y.y,
'2015' = x.x.x,
'2016' = x.y.y.y,
'2017' = x.x,
'2018' = x.y.y.y.y
)
filter_demo_pop<- function(df, year){
year <- enquo(year)
df <-
df %>%
select(State, !!year) %>%
mutate(Year = as.numeric(!!year)) %>%
rename(pop_est = !!year)
return(df)
}
hisp_pop_est <- rbind(filter_demo_pop(joined_pop_est, '2011' ),
filter_demo_pop(joined_pop_est, '2012' ),
filter_demo_pop(joined_pop_est, '2013' ),
filter_demo_pop(joined_pop_est, '2014' ),
filter_demo_pop(joined_pop_est, '2015' ),
filter_demo_pop(joined_pop_est, '2016' ),
filter_demo_pop(joined_pop_est, '2017' ),
filter_demo_pop(joined_pop_est, '2018' )) %>%
rename(hisp_est = pop_est) %>%
mutate(ID = paste(State, Year, sep = ', ')) %>%
select(hisp_est, ID)
combined_data <-
combined_data %>%
mutate(ID = paste(State, Year, sep = ', '))
hisp_data <-
inner_join(combined_data, hisp_pop_est, by = 'ID') %>%
mutate(hisp_per_pop = round(hisp_est / pop, 4)) %>%
select(ID, hisp_per_pop)
paimi_ethnic <-
read.csv('ethnicity data served by PAIMI.csv', stringsAsFactors = FALSE)
paimi_ethnic %>% colnames()
#imports paimi data
paimi_ethnic <-
read.csv('ethnicity data served by PAIMI.csv', stringsAsFactors = FALSE) %>%
mutate(Year = clean(ï..Year),
state_abr = States,
n_hisp = clean(Hispanic),
n_asian = clean(Asian),
a_total_indiv = clean(Clients.Served)) %>%
mutate(hispanic_PAIMI = round(n_hisp / a_total_indiv, 5)) %>%
select(Year, state_abr, hispanic_PAIMI)
abrev <-
cbind(state_abr = as.character(state.abb), State = as.character(state.name)) %>%
data.frame()
df <-
data_frame(state_abr = as.character(c('PR', 'DC' )) , State = as.character(c('Puerto Rico', 'District of Columbia')))
abrev <-
rbind(df, abrev)
paimi_ethnic <-
inner_join(paimi_ethnic, abrev, by = 'state_abr') %>%
mutate(ID = paste(State, Year, sep = ', '))
View(paimi_ethnic)
test <-
inner_join(paimi_ethnic, hisp_data)
View(test)
hisp_data <-
inner_join(paimi_ethnic, hisp_data) %>%
Select(-state_abr, -ID)
hisp_data <-
inner_join(paimi_ethnic, hisp_data, by = "ID") %>%
select(-state_abr, -ID)
hisp_data <-
inner_join(paimi_ethnic, hisp_data, by = "ID") %>%
select(-state_abr, -ID)
census_est <-
read.csv('sc-est2018-alldata6.csv') %>%
#where sex = 0 is both, and origin = 1 is non-hispanic and 2 is hispanic
filter(SEX == 0, ORIGIN == 2)
sum_by_demo <- function(col, year){
#returns
col <- enquo(col)
year <- enquo(year)
df <-
census_est %>%
group_by(NAME) %>%
summarise(x = sum(!!col)) %>%
mutate(ID = paste(NAME)) %>%
ungroup() %>%
select(-NAME)
return(df)
}
#nested join group in combo with the above function
joined_pop_est <- inner_join(sum_by_demo(POPESTIMATE2011, 2011),
inner_join(sum_by_demo(POPESTIMATE2012, 2012),
inner_join(sum_by_demo(POPESTIMATE2013, 2013),
inner_join(sum_by_demo(POPESTIMATE2014, 2014),
inner_join(sum_by_demo(POPESTIMATE2015, 2015),
inner_join(sum_by_demo(POPESTIMATE2016, 2016),
inner_join(sum_by_demo(POPESTIMATE2017, 2017),
sum_by_demo(POPESTIMATE2018, 2018),
by = 'ID'),
by = 'ID'),
by = 'ID'),
by = 'ID'),
by = 'ID'),
by = 'ID'),
by = 'ID') %>%
rename(State = ID) %>%
rename('2011' = x.x.x.x.x,
'2012' = x.y,
'2013' = x.x.x.x,
'2014' = x.y.y,
'2015' = x.x.x,
'2016' = x.y.y.y,
'2017' = x.x,
'2018' = x.y.y.y.y
)
filter_demo_pop<- function(df, year){
year <- enquo(year)
df <-
df %>%
select(State, !!year) %>%
mutate(Year = as.numeric(!!year)) %>%
rename(pop_est = !!year)
return(df)
}
hisp_pop_est <- rbind(filter_demo_pop(joined_pop_est, '2011' ),
filter_demo_pop(joined_pop_est, '2012' ),
filter_demo_pop(joined_pop_est, '2013' ),
filter_demo_pop(joined_pop_est, '2014' ),
filter_demo_pop(joined_pop_est, '2015' ),
filter_demo_pop(joined_pop_est, '2016' ),
filter_demo_pop(joined_pop_est, '2017' ),
filter_demo_pop(joined_pop_est, '2018' )) %>%
rename(hisp_est = pop_est) %>%
mutate(ID = paste(State, Year, sep = ', ')) %>%
select(hisp_est, ID)
combined_data <-
combined_data %>%
mutate(ID = paste(State, Year, sep = ', '))
hisp_data <-
inner_join(combined_data, hisp_pop_est, by = 'ID') %>%
mutate(hisp_per_pop = round(hisp_est / pop, 4)) %>%
select(ID, hisp_per_pop)
#imports paimi data
paimi_ethnic <-
read.csv('ethnicity data served by PAIMI.csv', stringsAsFactors = FALSE) %>%
mutate(Year = clean(ï..Year),
state_abr = States,
n_hisp = clean(Hispanic),
n_asian = clean(Asian),
a_total_indiv = clean(Clients.Served)) %>%
mutate(hispanic_PAIMI = round(n_hisp / a_total_indiv, 5)) %>%
select(Year, state_abr, hispanic_PAIMI)
abrev <-
cbind(state_abr = as.character(state.abb), State = as.character(state.name)) %>%
data.frame()
df <-
data_frame(state_abr = as.character(c('PR', 'DC' )) , State = as.character(c('Puerto Rico', 'District of Columbia')))
abrev <-
rbind(df, abrev)
paimi_ethnic <-
inner_join(paimi_ethnic, abrev, by = 'state_abr') %>%
mutate(ID = paste(State, Year, sep = ', '))
hisp_data <-
inner_join(paimi_ethnic, hisp_data, by = "ID") %>%
select(-state_abr, -ID)
test <-
hisp_data %>%
group_by(State) %>%
summarise(avg_PAIMI = mean(hispanic_PAIMI)) %>%
summarise(avg_pop = mean(hisp_per_pop))
test <-
hisp_data %>%
group_by(State) %>%
summarise(avg_PAIMI = mean(hispanic_PAIMI),
avg_pop = mean(hisp_per_pop))
?mean
test <-
hisp_data %>%
group_by(State) %>%
summarise(avg_PAIMI = mean(hispanic_PAIMI, na.rm = TRUE ),
avg_pop = mean(hisp_per_pop, na.rm = TRUE))
