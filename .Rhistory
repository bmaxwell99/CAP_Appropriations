State names that are light in color recieved many dollars for every person in the state. ',
caption = '*Workload equal to number of cases worked divided by funding
**Dollars of funding recieved per capita'
) #+
#Uses the name of the states in a text plot to show that
ggplot(data=workload_w_state %>% filter(funding < 140000, fund_per_pop > .15)
#%>% filter(fund_per_pop >= .10)
) +
aes(x=Year, y= work_per_dol, label = State, color = fund_per_pop)+
geom_text() +
labs(x = "Year",
y = "*Workload Relative Resources",
color = '**Ratio of Funding per Capita',
title = 'Visual Exploration for State Performance(Workload) Relative to Comparable States',
subtitle = 'The State names that are high worked more cases for every dollar of funding they recieved.
State names that are light in color recieved many dollars for every person in the state. ',
caption = '*Workload equal to number of cases worked divided by funding
**Dollars of funding recieved per capita'
) +
scale_color_gradient(low = 'blue', high = 'red')
#Uses the name of the states in a text plot to show that
ggplot(data=workload_w_state %>% filter(funding < 140000, fund_per_pop > .15)
#%>% filter(fund_per_pop >= .10)
) +
aes(x=Year, y= work_per_dol, label = State, color = fund_per_pop)+
geom_text() +
labs(x = "Year",
y = "*Workload Relative Resources",
color = '**Ratio of Funding per Capita',
title = 'Visual Exploration for State Performance(Workload) Relative to Comparable States',
subtitle = 'The State names that are high worked more cases for every dollar of funding they recieved.
State names that are light in color recieved many dollars for every person in the state. ',
caption = '*Workload equal to number of cases worked divided by funding
**Dollars of funding recieved per capita'
) +
scale_color_gradient(low = 'red', high = 'blue')
#Uses the name of the states in a text plot to show that
ggplot(data=workload_w_state %>% filter(funding < 140000, fund_per_pop > .15)
#%>% filter(fund_per_pop >= .10)
) +
aes(x=Year, y= work_per_dol, label = State, color = fund_per_pop)+
geom_text() +
labs(x = "Year",
y = "*Workload Relative Resources",
color = '**Ratio of Funding per Capita',
title = 'Visual Exploration for State Performance(Workload) Relative to Comparable States',
subtitle = 'The State names that are high worked more cases for every dollar of funding they recieved.
State names that are light in color recieved many dollars for every person in the state. ',
caption = '*Workload equal to number of cases worked divided by funding
**Dollars of funding recieved per capita'
) +
scale_color_gradient(low = 'red', high = 'gold')
#Uses the name of the states in a text plot to show that
ggplot(data=workload_w_state %>% filter(funding < 140000, fund_per_pop > .15)
#%>% filter(fund_per_pop >= .10)
) +
aes(x=Year, y= work_per_dol, label = State, color = fund_per_pop)+
geom_text() +
labs(x = "Year",
y = "*Workload Relative Resources",
color = '**Ratio of Funding per Capita',
title = 'Visual Exploration for State Performance(Workload) Relative to Comparable States',
subtitle = 'The State names that are high worked more cases for every dollar of funding they recieved.
State names that are light in color recieved many dollars for every person in the state. ',
caption = '*Workload equal to number of cases worked divided by funding
**Dollars of funding recieved per capita'
) +
scale_color_gradient(low = 'red', high = 'light blue')
#Uses the name of the states in a text plot to show that
ggplot(data=workload_w_state %>% filter(funding < 140000, fund_per_pop > .15)
#%>% filter(fund_per_pop >= .10)
) +
aes(x=Year, y= work_per_dol, label = State, color = fund_per_pop)+
geom_text() +
labs(x = "Year",
y = "*Workload Relative Resources",
color = '**Ratio of Funding per Capita',
title = 'Visual Exploration for State Performance(Workload) Relative to Comparable States',
subtitle = 'The State names that are high worked more cases for every dollar of funding they recieved.
State names that are light in color recieved many dollars for every person in the state. ',
caption = '*Workload equal to number of cases worked divided by funding
**Dollars of funding recieved per capita'
) +
scale_color_gradient(low = 'red', high = 'blue')
#Uses the name of the states in a text plot to show that
ggplot(data=workload_w_state %>% filter(funding < 140000, fund_per_pop > .15)
#%>% filter(fund_per_pop >= .10)
) +
aes(x=Year, y= work_per_dol, label = State, color = fund_per_pop)+
geom_text() +
labs(x = "Year",
y = "*Workload Relative Resources",
color = '**Ratio of Funding per Capita',
title = 'Visual Exploration for State Performance(Workload) Relative to Comparable States',
subtitle = 'The State names that are high worked more cases for every dollar of funding they recieved.
State names that are light in color recieved many dollars for every person in the state. ',
caption = '*Workload equal to number of cases worked divided by funding
**Dollars of funding recieved per capita'
) +
scale_color_gradient(low = 'red', high = 'blue')
#text graphs work per dollar with a log scale of population
ggplot(data = workload_w_state %>% filter(Year == 2018, funding < 140000)
)+
aes(x = log(pop),
y = work_per_dol,
label = State)+
geom_text()
source('Clean_join_data.r')
source('comparable_states_graph.r')
row.names(bucketed_data) <- c(unlist(bucketed_data[1]))
pca <- prcomp(bucketed_data %>% select(pop_18,dollar_2018) , scale = TRUE)
pca <- prcomp(bucketed_data %>% select(pop_18,dollar_2018) %>% filter(dollar_2018 > 140000), scale = TRUE)
plot(pca$x[,1], pca$x[,2])
pca.var <- pca$sdev^2
pca.var.per <- round(pca.var/sum(pca.var)*100, 1)
barplot(pca.var.per, main = 'variation in percent of variation', xlab = 'Principle component', ylab = 'Percent Variation')
pca_data <-
data_frame(State = rownames(pca$x),
X = pca$x[,1],
Y = pca$x[,2])
## get the name of the top 10 measurements (genes) that contribute
## most to pc1.
loading_scores <- pca$rotation[,1]
gene_scores <- abs(loading_scores) ## get the magnitudes
gene_score_ranked <- sort(gene_scores, decreasing=TRUE)
top_10_genes <- names(gene_score_ranked[1:3])
top_10_genes
pca_data <-
data_frame(State = rownames(pca$x),
X = pca$x[,1],
Y = pca$x[,2])
row.names(bucketed_data) <- c(unlist(bucketed_data[1]))
pca <- prcomp(bucketed_data %>% select(pop_18,dollar_2018) %>% filter(dollar_2018 > 140000), scale = TRUE)
plot(pca$x[,1], pca$x[,2])
pca.var <- pca$sdev^2
pca.var.per <- round(pca.var/sum(pca.var)*100, 1)
barplot(pca.var.per, main = 'variation in percent of variation', xlab = 'Principle component', ylab = 'Percent Variation')
pca_data <-
data_frame(State = rownames(pca$x),
X = pca$x[,1],
Y = pca$x[,2])
pca_data <-
data_frame(State = c(rownames(pca$x)),
X = pca$x[,1],
Y = pca$x[,2])
View(pca)
pca <- prcomp(bucketed_data %>% select(State, pop_18,dollar_2018) %>% filter(dollar_2018 > 140000), scale = TRUE)
pca_data <-
data_frame(State = rownames(bucketed_data$State),
X = pca$x[,1],
Y = pca$x[,2])
pca_data <-
data_frame(State = 'rownames(bucketed_data$State)',
X = pca$x[,1],
Y = pca$x[,2])
View(pca_data)
barplot(pca.var.per, main = 'variation in percent of variation', xlab = 'Principle component', ylab = 'Percent Variation')
pca_data <-
data_frame(State = rownames(pca$x),
X = pca$x[,1],
Y = pca$x[,2])
pca_data <-
data_frame(State = rownames(pca$x),
X = pca$x[,1],
Y = pca$x[,2])
#plots against dollars recieved per population
ggplot(data = bucketed_data #%>% filter(dollar_2018 < 141000) %>% filter(State = )
) +
aes(x = reorder(State, -dol_per_pop_18)  ,
y = dol_per_pop_18 ,
fill =  funding_cat_18
) +
geom_col() +
coord_flip() +
labs(x = "States",
y = "Dollars of Funding Received per Population in 2018**",
fill = '*Approx Funding Received in 2018',
title = 'Visual Exploration for 2018 Comparable States(CAP)',
subtitle = 'The States that are similar in terms of bar length(calculated by number of dollars received per person)
may be comparable to each other, despite the differences in funding they recieve(shown via color) ',
caption = '*Funding amounts drawn from RSA CAP appropriations
**Estimated Population drawn from Census Bureau'
) +
scale_fill_hue(h = c(0, 270))
#Uses the name of the states in a text plot to show that
ggplot(data=workload_w_state %>% filter(funding < 140000, fund_per_pop > .15)
#%>% filter(fund_per_pop >= .10)
) +
aes(x=Year, y= work_per_dol, label = State, color = fund_per_pop)+
geom_text() +
labs(x = "Year",
y = "*Workload Relative Resources",
color = '**Ratio of Funding per Capita',
title = 'Visual Exploration for State Performance(Workload) Relative to Comparable States',
subtitle = 'The State names that are high worked more cases for every dollar of funding they recieved.
State names that are light in color recieved many dollars for every person in the state. ',
caption = '*Workload equal to number of cases worked divided by funding
**Dollars of funding recieved per capita'
) +
scale_color_gradient(low = 'red', high = 'blue')
#text graphs work per dollar with a log scale of population
ggplot(data = workload_w_state %>% filter(Year == 2018, funding < 140000)
)+
aes(x = log(pop),
y = work_per_dol,
label = State)+
geom_text()
#Uses the name of the states in a text plot to show that
ggplot(data=workload_w_state %>% filter(funding < 140000, fund_per_pop > .15)
#%>% filter(fund_per_pop >= .10)
) +
aes(x=Year, y= work_per_dol, label = State, color = fund_per_pop)+
geom_text() +
labs(x = "Year",
y = "*Workload Relative Resources",
color = '**Ratio of Funding per Capita',
title = 'Visual Exploration for State Performance(Workload) Relative to Comparable States',
subtitle = 'The State names that are vertically high, worked more cases for every dollar of funding they recieved.
State names that are light in color recieved many dollars for every person in the state. ',
caption = '*Workload equal to number of cases worked divided by funding
**Dollars of funding recieved per capita'
) +
scale_color_gradient(low = 'red', high = 'blue')
workload_relative_funding_graph <-function(df){
ggplot(data= df)+
aes(x=Year, y= work_per_dol, label = State, color = fund_per_pop)+
geom_text() +
labs(x = "Year",
y = "*Workload Relative Resources",
color = '**Ratio of Funding per Capita',
title = 'Visual Exploration for State Performance(Workload) Relative to Comparable States',
subtitle = 'The State names that are vertically high, worked more cases for every dollar of funding they recieved.
State names that are light in color recieved many dollars for every person in the state. ',
caption = '*Workload equal to number of cases worked divided by funding
**Dollars of funding recieved per capita'
) +
scale_color_gradient(low = 'red', high = 'blue')
}
ggplot(data= df)+
aes(x=Year, y= work_per_dol, label = State, color = fund_per_pop)+
geom_text() +
labs(x = "Year",
y = "*Workload Relative Resources",
color = '**Ratio of Funding per Capita',
title = 'Visual Exploration for State Performance(Workload) Relative to Comparable States',
subtitle = 'The State names that are vertically high, worked more cases for every dollar of funding they recieved.
State names that are light in color recieved many dollars for every person in the state. ',
caption = '*Workload equal to number of cases worked divided by funding
**Dollars of funding recieved per capita'
) +
scale_color_gradient(low = 'blue', high = 'red')
workload_relative_funding_graph <-function(df){
ggplot(data= df)+
aes(x=Year, y= work_per_dol, label = State, color = fund_per_pop)+
geom_text() +
labs(x = "Year",
y = "*Workload Relative Resources",
color = '**Ratio of Funding per Capita',
title = 'Visual Exploration for State Performance(Workload) Relative to Comparable States',
subtitle = 'The State names that are vertically high, worked more cases for every dollar of funding they recieved.
State names that are light in color recieved many dollars for every person in the state. ',
caption = '*Workload equal to number of cases worked divided by funding
**Dollars of funding recieved per capita'
) +
scale_color_gradient(low = 'blue', high = 'red')
}
workload_relative_funding_graph(workload_w_state %>% filter(funding < 140000, fund_per_pop > .15))
ggplot(data= df)+
aes(x=Year, y= work_per_dol, label = State, color = fund_per_pop)+
geom_text() +
labs(x = "Year",
y = "*Workload Relative Resources",
color = '**Ratio of Funding per Capita',
title = 'Visual Exploration for State Performance(Workload) Relative to Comparable States',
subtitle = 'The State names that are vertically high, worked more cases for every dollar of funding they recieved.
State names that are light in color recieved many dollars for every person in the state. ',
caption = '*Workload equal to number of cases worked divided by funding
**Dollars of funding recieved per capita'
) +
scale_color_gradient()
setwd("C:/Users/dark_/Documents/NDRN/CAP_Appropriations")
source('workload_calc.R')
workload_relative_funding_graph <-function(df){
ggplot(data= df)+
aes(x=Year, y= work_per_dol, label = State, color = fund_per_pop)+
geom_text() +
labs(x = "Year",
y = "*Workload Relative Resources",
color = '**Ratio of Funding per Capita',
title = 'Visual Exploration for State Performance(Workload) Relative to Comparable States',
subtitle = 'The State names that are vertically high, worked more cases for every dollar of funding they recieved.
State names that are light in color recieved many dollars for every person in the state. ',
caption = '*Workload equal to number of cases worked divided by funding
**Dollars of funding recieved per capita'
) +
scale_color_gradient()
}
workload_relative_funding_graph(workload_w_state %>% filter(funding < 140000, fund_per_pop > .15))
#text graphs work per dollar with a log scale of population
ggplot(data = workload_w_state %>% filter(Year == 2018, funding < 140000)
)+
aes(x = log(pop),
y = work_per_dol,
label = State)+
geom_text()
workload_relative_funding_graph <-function(df){
ggplot(data= df)+
aes(x=Year, y= work_per_dol, label = State, color = fund_per_pop)+
geom_text() +
labs(x = "Year",
y = "*Workload Relative Resources",
color = '**Ratio of Funding per Capita',
title = 'Visual Exploration for State Performance(Workload) Relative to Comparable States',
subtitle = 'The State names that are vertically high, worked more cases for every dollar of funding they recieved.
State names that are light in color recieved many dollars for every person in the state. ',
caption = '*Workload equal to number of cases worked divided by funding
**Dollars of funding recieved per capita'
) +
scale_color_gradient()
}
workload_relative_funding_graph <-function(df){
ggplot(data= df)+
aes(x=Year, y= work_per_dol, label = State, color = fund_per_pop)+
geom_text() +
labs(x = "Year",
y = "*Workload Relative Resources",
color = '**Ratio of Funding per Capita',
title = 'Visual Exploration for State Performance(Workload) Relative to Comparable States',
subtitle = 'The State names that are vertically high, worked more cases for every dollar of funding they recieved.
State names that are light in color recieved many dollars for every person in the state. ',
caption = '*Workload equal to number of cases worked divided by funding
**Dollars of funding recieved per capita'
) +
scale_color_gradient()
}
workload_relative_funding_graph(workload_w_state %>% filter(funding < 140000, fund_per_pop > .15))
pca_data <-
data_frame(State = rownames(pca$x),
X = pca$x[,1],
Y = pca$x[,2])
library(dplyr)
library(magrittr)
library(tidyr)
library(stringr)
library(ggplot2)
setwd("C:/Users/dark_/Documents/NDRN/CAP_Appropriations")
source('workload_calc.R')
#preps the data for graphing
workload_w_state_18 <-
workload_w_state %>%
filter(Year == 2018) %>%
arrange(compare_cat_18,work_relative_resources) %>%
mutate(.r = row_number())
#groups by compare bucket and seperates into facets
ggplot(data = workload_w_state_18) +
aes(x = reorder(State, -.r),
y = work_relative_resources,
fill = fund_cat) +
coord_flip() +
geom_col() +
facet_grid(.~compare_cat_18) +
scale_fill_hue(h = c(0,270))
#Plots a single category
work_rel_resource_cat <- function(cat){
ggplot(data = workload_w_state_18 %>%
filter(compare_cat_18 == cat)) +
aes(x = reorder(State, -.r),
y = work_relative_resources,
fill = fund_cat) +
coord_flip() +
geom_col() +
scale_fill_hue(h = c(0,270))
}
work_rel_resource_cat('<.05')
workload_relative_funding_graph <-function(df){
ggplot(data= df)+
aes(x=Year, y= work_per_dol, label = State, color = fund_per_pop)+
geom_text() +
labs(x = "Year",
y = "*Workload Relative Resources",
color = '**Ratio of Funding per Capita',
title = 'Visual Exploration for State Performance(Workload) Relative to Comparable States',
subtitle = 'The State names that are vertically high, worked more cases for every dollar of funding they recieved.
State names that are light in color recieved many dollars for every person in the state. ',
caption = '*Workload equal to number of cases worked divided by funding
**Dollars of funding recieved per capita'
) +
scale_color_gradient()
}
workload_relative_funding_graph(workload_w_state %>% filter(funding < 140000, fund_per_pop > .15))
workload_relative_funding_graph <-function(df){
ggplot(data= df)+
aes(x=Year, y= work_per_dol, label = State, color = fund_per_pop)+
geom_text(nudge_x = 1, nudge_y = 1) +
labs(x = "Year",
y = "*Workload Relative Resources",
color = '**Ratio of Funding per Capita',
title = 'Visual Exploration for State Performance(Workload) Relative to Comparable States',
subtitle = 'The State names that are vertically high, worked more cases for every dollar of funding they recieved.
State names that are light in color recieved many dollars for every person in the state. ',
caption = '*Workload equal to number of cases worked divided by funding
**Dollars of funding recieved per capita'
) +
scale_color_gradient()
}
workload_relative_funding_graph(workload_w_state %>% filter(funding < 140000, fund_per_pop > .15))
ggplot(data= df)+
aes(x=Year, y= work_per_dol, label = State, color = fund_per_pop)+
geom_text(nudge_x = 1, nudge_y = ) +
geom_point() +
labs(x = "Year",
y = "*Workload Relative Resources",
color = '**Ratio of Funding per Capita',
title = 'Visual Exploration for State Performance(Workload) Relative to Comparable States',
subtitle = 'The State names that are vertically high, worked more cases for every dollar of funding they recieved.
State names that are light in color recieved many dollars for every person in the state. ',
caption = '*Workload equal to number of cases worked divided by funding
**Dollars of funding recieved per capita'
) +
scale_color_gradient()
ggplot(data= df)+
aes(x=Year, y= work_per_dol, label = State, color = fund_per_pop)+
geom_text(nudge_x = 1, nudge_y = 1) +
geom_point() +
labs(x = "Year",
y = "*Workload Relative Resources",
color = '**Ratio of Funding per Capita',
title = 'Visual Exploration for State Performance(Workload) Relative to Comparable States',
subtitle = 'The State names that are vertically high, worked more cases for every dollar of funding they recieved.
State names that are light in color recieved many dollars for every person in the state. ',
caption = '*Workload equal to number of cases worked divided by funding
**Dollars of funding recieved per capita'
) +
scale_color_gradient()
workload_relative_funding_graph <-function(df){
ggplot(data= df)+
aes(x=Year, y= work_per_dol, label = State, color = fund_per_pop)+
geom_text(nudge_x = 1, nudge_y = 1) +
geom_point() +
labs(x = "Year",
y = "*Workload Relative Resources",
color = '**Ratio of Funding per Capita',
title = 'Visual Exploration for State Performance(Workload) Relative to Comparable States',
subtitle = 'The State names that are vertically high, worked more cases for every dollar of funding they recieved.
State names that are light in color recieved many dollars for every person in the state. ',
caption = '*Workload equal to number of cases worked divided by funding
**Dollars of funding recieved per capita'
) +
scale_color_gradient()
}
workload_relative_funding_graph(workload_w_state %>% filter(funding < 140000, fund_per_pop > .15))
workload_relative_funding_graph <-function(df){
ggplot(data= df)+
aes(x=Year, y= work_per_dol, label = State, color = fund_per_pop)+
geom_text() +
geom_point() +
labs(x = "Year",
y = "*Workload Relative Resources",
color = '**Ratio of Funding per Capita',
title = 'Visual Exploration for State Performance(Workload) Relative to Comparable States',
subtitle = 'The State names that are vertically high, worked more cases for every dollar of funding they recieved.
State names that are light in color recieved many dollars for every person in the state. ',
caption = '*Workload equal to number of cases worked divided by funding
**Dollars of funding recieved per capita'
) +
scale_color_gradient()
}
workload_relative_funding_graph(workload_w_state %>% filter(funding < 140000, fund_per_pop > .15))
df <- workload_w_state %>% filter(State == c('Wyoming', 'Vermont'))
df <- workload_w_state %>% filter(State == 'Wyoming' | State == 'Vermont')
workload_relative_funding_graph(df)
workload_relative_funding_graph <-function(df){
ggplot(data= df)+
aes(x=Year, y= work_per_dol, label = State, color = fund_per_pop)+
geom_text() +
labs(x = "Year",
y = "*Workload Relative Resources",
color = '**Ratio of Funding per Capita',
title = 'Visual Exploration for State Performance(Workload) Relative to Comparable States',
subtitle = 'The State names that are vertically high, worked more cases for every dollar of funding they recieved.
State names that are light in color recieved many dollars for every person in the state. ',
caption = '*Workload equal to number of cases worked divided by funding
**Dollars of funding recieved per capita'
) +
scale_color_gradient()
}
df <- workload_w_state %>% filter(funding < 140000, fund_per_pop > .15)
df <- workload_w_state %>% filter(State == 'Wyoming' | State == 'Vermont')
workload_relative_funding_graph(df)
df <- workload_w_state %>% filter(funding < 140000, fund_per_pop > .15)
workload_relative_funding_graph(df)
#text graphs work per dollar with a log scale of population
ggplot(data = workload_w_state %>% filter(Year == 2018, funding < 140000)
)+
aes(x = log(pop),
y = work_per_dol,
label = State)+
geom_text()
cor(workload_w_state$work_per_dol, workload_w_state$pop )
workload_w_state$work_per_dol[1]
View(workload_w_state)
cor(workload_w_state$work_per_dol[1], workload_w_state$pop[1] )
workload_w_state$pop[1]
lm(workload_w_state$work_per_dol ~ workload_w_state$pop)
#text graphs work per dollar with a log scale of population
ggplot(data = workload_w_state %>% filter(Year == 2018, funding < 140000)
)+
aes(x = log(pop),
y = work_per_dol,
label = State)+
geom_text()
View(indiv_cases_stdzed)
