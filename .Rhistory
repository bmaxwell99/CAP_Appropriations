workload_w_state %>% filter(State == 'New York') %>%  View()
df_regress <-
workload_w_state %>%
#combines the two connecticut agencies in 2017 into just one
filter(ID != '2017, Connecticut, Disability Rights Connecticut') %>%
mutate(workload = replace(workload,
State == 'Connecticut'& Year == 2017,
53)) %>%
mutate(d_1_favorable = replace(d_1_favorable,
State == 'Connecticut'& Year == 2017,
25)) %>%
#combines the two DC line items in 2011 into just one
filter(workload != 65 | ID != '2011, District of Columbia, University Legal Services, Inc.') %>%
mutate(workload = replace(workload,
State == 'District of Columbia'& Year == 2011,
102)) %>%
mutate(c_6_formal_review = replace(c_6_formal_review,
State == 'District of Columbia'& Year == 2011,
15)) %>%
mutate(d_1_favorable = replace(d_1_favorable,
State == 'District of Columbia'& Year == 2011,
25)) %>%
mutate(d_2_some_favor = replace(d_2_some_favor,
State == 'District of Columbia'& Year == 2011,
19)) %>%
mutate(d_7_not_favor = replace(d_7_not_favor,
State == 'District of Columbia'& Year == 2011,
2)) %>%
mutate(d_10_lack_resources = replace(d_10_lack_resources,
State == 'District of Columbia'& Year == 2011,
1)) %>%
#combines the two Nevada agencies into one line
filter(ID != '2013, Nevada, State Of Nevada Rehabilitation Division') %>%
mutate(workload = replace(workload,
State == 'Nevada'& Year == 2013,
40)) %>%
mutate(c_5_informal_review = replace(c_5_informal_review,
State == 'Nevada'& Year == 2013,
5)) %>%
mutate(c_6_formal_review = replace(c_6_formal_review,
State == 'Nevada'& Year == 2013,
3)) %>%
mutate(d_1_favorable = replace(d_1_favorable,
State == 'Nevada'& Year == 2013,
13)) %>%
mutate(d_2_some_favor = replace(d_2_some_favor,
State == 'Nevada'& Year == 2013,
2)) %>%
mutate(d_7_not_favor = replace(d_7_not_favor,
State == 'Nevada'& Year == 2013,
1)) %>%
mutate(d_10_lack_resources = replace(d_10_lack_resources,
State == 'Nevada'& Year == 2013,
1)) %>%
#combines the two New York agencies into one line
filter(ID != '2013, New York, Disability Advocates, Inc. dba DRNY') %>%
mutate(workload = replace(workload,
State == 'New York'& Year == 2013,
826)) %>%
mutate(c_5_informal_review = replace(c_5_informal_review,
State == 'New York'& Year == 2013,
13)) %>%
mutate(d_1_favorable = replace(d_1_favorable,
State == 'New York' & Year == 2013,
126)) %>%
mutate(d_2_some_favor = replace(d_2_some_favor,
State == 'New York'& Year == 2013,
62)) %>%
#combines the South Carolina agencies into one line
filter(ID != '2015, South Carolina, Department of Admin. Client Assistance Program') %>%
mutate(workload = replace(workload,
State == 'South Carolina'& Year == 2015,
151)) %>%
mutate(c_5_informal_review = replace(c_5_informal_review,
State == 'South Carolina'& Year == 2015,
39)) %>%
mutate(d_1_favorable = replace(d_1_favorable,
State == 'South Carolina'& Year == 2015,
61)) %>%
mutate(d_2_some_favor = replace(d_2_some_favor,
State == 'South Carolina'& Year == 2015,
48)) %>%
mutate(d_7_not_favor = replace(d_7_not_favor,
State == 'South Carolina'& Year == 2015,
4)) %>%
#recomputes per ratios to reflect the above changes
mutate( work_per_pop = round(workload / pop * 100000, 8), #cases per 100,000 people
work_per_dol = round(workload / funding * 100000, 5), #cases per 100,000 dollars in funding
c_5_per_work = round(c_5_informal_review / workload, 5),
c_6_per_work = round(c_6_formal_review / workload, 5),
c_7_per_work = round(c_7_legal / workload, 5),
d_1_per_work = round(d_1_favorable / workload, 5),
d_2_per_work = round(d_2_some_favor / workload, 5),
d_7_per_work = round(d_7_not_favor / workload, 5),
d_10_per_work = round(d_10_lack_resources / workload, 5),
d_11_per_work = round(d_11_conflict / workload, 5))
workload_w_state %>%
filter(ID != '2017, Connecticut, Disability Rights Connecticut') %>%
filter(workload != 65 | ID != '2011, District of Columbia, University Legal Services, Inc.') %>%
filter(ID != '2013, New York, Disability Advocates, Inc. dba DRNY') %>%
filter(ID != '2015, South Carolina, Department of Admin. Client Assistance Program') %>%
nrow()
df_regress %>% group_by(State) %>% summarise(n = n_distinct(Year)) %>% arrange(n)
workload_w_state %>% group_by(State) %>% summarise(n = n()) %>% filter(n > 8)
df_regress <-
workload_w_state %>%
#combines the two connecticut agencies in 2017 into just one
filter(ID != '2017, Connecticut, Disability Rights Connecticut') %>%
mutate(workload = replace(workload,
State == 'Connecticut'& Year == 2017,
53)) %>%
mutate(d_1_favorable = replace(d_1_favorable,
State == 'Connecticut'& Year == 2017,
25)) %>%
#combines the two DC line items in 2011 into just one
filter(workload != 65 | ID != '2011, District of Columbia, University Legal Services, Inc.') %>%
mutate(workload = replace(workload,
State == 'District of Columbia'& Year == 2011,
102)) %>%
mutate(c_6_formal_review = replace(c_6_formal_review,
State == 'District of Columbia'& Year == 2011,
15)) %>%
mutate(d_1_favorable = replace(d_1_favorable,
State == 'District of Columbia'& Year == 2011,
25)) %>%
mutate(d_2_some_favor = replace(d_2_some_favor,
State == 'District of Columbia'& Year == 2011,
19)) %>%
mutate(d_7_not_favor = replace(d_7_not_favor,
State == 'District of Columbia'& Year == 2011,
2)) %>%
mutate(d_10_lack_resources = replace(d_10_lack_resources,
State == 'District of Columbia'& Year == 2011,
1)) %>%
#combines the two Nevada agencies into one line
filter(ID != '2013, Nevada, State Of Nevada Rehabilitation Division') %>%
mutate(workload = replace(workload,
State == 'Nevada'& Year == 2013,
40)) %>%
mutate(c_5_informal_review = replace(c_5_informal_review,
State == 'Nevada'& Year == 2013,
5)) %>%
mutate(c_6_formal_review = replace(c_6_formal_review,
State == 'Nevada'& Year == 2013,
3)) %>%
mutate(d_1_favorable = replace(d_1_favorable,
State == 'Nevada'& Year == 2013,
13)) %>%
mutate(d_2_some_favor = replace(d_2_some_favor,
State == 'Nevada'& Year == 2013,
2)) %>%
mutate(d_7_not_favor = replace(d_7_not_favor,
State == 'Nevada'& Year == 2013,
1)) %>%
mutate(d_10_lack_resources = replace(d_10_lack_resources,
State == 'Nevada'& Year == 2013,
1)) %>%
#combines the two New York agencies into one line
filter(ID != '2013, New York, Disability Advocates, Inc. dba DRNY') %>%
mutate(workload = replace(workload,
State == 'New York'& Year == 2013,
826)) %>%
mutate(c_5_informal_review = replace(c_5_informal_review,
State == 'New York'& Year == 2013,
13)) %>%
mutate(d_1_favorable = replace(d_1_favorable,
State == 'New York' & Year == 2013,
126)) %>%
mutate(d_2_some_favor = replace(d_2_some_favor,
State == 'New York'& Year == 2013,
62)) %>%
#combines the South Carolina agencies into one line
filter(ID != '2015, South Carolina, Department of Admin. Client Assistance Program') %>%
mutate(workload = replace(workload,
State == 'South Carolina'& Year == 2015,
151)) %>%
mutate(c_5_informal_review = replace(c_5_informal_review,
State == 'South Carolina'& Year == 2015,
39)) %>%
mutate(d_1_favorable = replace(d_1_favorable,
State == 'South Carolina'& Year == 2015,
61)) %>%
mutate(d_2_some_favor = replace(d_2_some_favor,
State == 'South Carolina'& Year == 2015,
48)) %>%
mutate(d_7_not_favor = replace(d_7_not_favor,
State == 'South Carolina'& Year == 2015,
4)) %>%
#recomputes per ratios to reflect the above changes
mutate( work_per_pop = round(workload / pop * 100000, 8), #cases per 100,000 people
work_per_dol = round(workload / funding * 100000, 5), #cases per 100,000 dollars in funding
c_5_per_work = round(c_5_informal_review / workload, 5),
c_6_per_work = round(c_6_formal_review / workload, 5),
c_7_per_work = round(c_7_legal / workload, 5),
d_1_per_work = round(d_1_favorable / workload, 5),
d_2_per_work = round(d_2_some_favor / workload, 5),
d_7_per_work = round(d_7_not_favor / workload, 5),
d_10_per_work = round(d_10_lack_resources / workload, 5),
d_11_per_work = round(d_11_conflict / workload, 5))
#adds regression
workload_regression <-
df_regress %>%
group_by(State) %>%
summarise(p_value_work_per_pop = p_calc(Year, work_per_pop, 8),
lm_work_per_pop = p_calc(Year,work_per_pop,  2),
p_value_pop = p_calc(Year, pop, 8),
lm__pop = p_calc(Year, pop, 2),
p_value_work = p_calc(Year, workload, 8),
lm_work = p_calc(Year,workload,  2)
)
ggplot(data = workload_w_state)+
aes(x = factor(Year),
y = work_per_pop
) +
geom_boxplot()
ggplot() +
aes(x = reorder(State, work_lm),
y = work_lm,
fill = factor(pop_cat)) +
geom_col(data = test %>% filter(p_value < .05))+
coord_flip() +
scale_fill_hue(h = c(0,270))
df <- workload_regression %>% filter(p_value_work_per_pop < .10 & p_value_pop < .10 )
test <- inner_join(workload_w_state %>% select(State, fund_cat), df, by = 'State')
ggplot(data = df_regress)+
aes(x = factor(Year),
y = work_per_pop
) +
geom_boxplot()
ggplot() +
aes(x = reorder(State, work_lm),
y = work_lm,
fill = factor(pop_cat)) +
geom_col(data = test %>% filter(p_value < .05))+
coord_flip() +
scale_fill_hue(h = c(0,270))
df1 <- df_regress %>%  group_by(State) %>% distinct(agency_name, Year)
df2 <-df_regress %>%  group_by(State) %>% summarise(n = n_distinct(agency_name)) %>%  filter(n > 1) %>% select(State)
df3 <- right_join(df1, df2, by= "State")
ggplot(data = workload_w_state %>%  filter(State == 'Connecticut')) +
aes(x = factor(Year),
y = work_per_pop,
color = agency_name) +
geom_point()
#adds regression
workload_regression <-
df_regress %>%
group_by(State) %>%
summarise(p_value_work_per_pop = p_calc(Year, work_per_pop, 8),
lm_work_per_pop = p_calc(Year,work_per_pop,  2),
p_value_pop = p_calc(Year, pop, 8),
lm__pop = p_calc(Year, pop, 2),
p_value_work = p_calc(Year, workload, 8),
lm_work = p_calc(Year,workload,  2)
)
df <- workload_regression %>% filter(p_value_work_per_pop < .10 & p_value_pop < .10 )
test <- inner_join(df_regress %>% select(State, fund_cat, pop_cat), df, by = 'State')
ggplot(data = df_regress)+
aes(x = factor(Year),
y = work_per_pop
) +
geom_boxplot()
ggplot() +
aes(x = reorder(State, work_lm),
y = work_lm,
fill = factor(pop_cat)) +
geom_col(data = test %>% filter(p_value < .05))+
coord_flip() +
scale_fill_hue(h = c(0,270))
ggplot() +
aes(x = reorder(State, work_lm),
y = work_lm,
fill = factor(pop_cat)) +
geom_col(data = bar_data))+
coord_flip() +
scale_fill_hue(h = c(0,270))
ggplot() +
aes(x = reorder(State, work_lm),
y = work_lm,
fill = factor(pop_cat)) +
geom_col(data = bar_data))+
coord_flip() +
scale_fill_hue(h = c(0,270))
ggplot() +
aes(x = reorder(State, work_lm),
y = work_lm,
fill = factor(pop_cat)) +
geom_col(data = bar_data)+
coord_flip() +
scale_fill_hue(h = c(0,270))
test <- inner_join(df_regress %>% select(State, fund_cat, pop_cat), df, by = 'State')
ggplot() +
aes(x = reorder(State, work_lm),
y = work_lm,
fill = factor(pop_cat)) +
geom_col(data = test %>% filter(p_value < .05))+
coord_flip() +
scale_fill_hue(h = c(0,270))
ggplot() +
aes(x = reorder(State, work_lm),
y = work_lm,
fill = factor(pop_cat)) +
geom_col(data = test)+
coord_flip() +
scale_fill_hue(h = c(0,270))
bar_data
bar_data <- df %>% group_by(pop_cat) %>% summarise(avg_lm_pop_cat = mean(work_lm))
df1 <- df_regress %>%  group_by(State) %>% distinct(agency_name, Year)
df2 <-df_regress %>%  group_by(State) %>% summarise(n = n_distinct(agency_name)) %>%  filter(n > 1) %>% select(State)
df3 <- right_join(df1, df2, by= "State")
ggplot(data = workload_w_state) +
aes(x = factor(Year),
y = work_per_pop,
color = agency_name) +
geom_point()
ggplot(data = workload_w_state) +
aes(x = factor(Year),
y = work_per_pop,
color = agency_name) +
geom_point()
ggplot(data = d3) +
aes(x = factor(Year),
y = work_per_pop,
color = agency_name) +
geom_point()
df1 <- df_regress %>%  group_by(State) %>% distinct(agency_name, Year)
df2 <-df_regress %>%  group_by(State) %>% summarise(n = n_distinct(agency_name)) %>%  filter(n > 1) %>% select(State)
df3 <- right_join(df1, df2, by= "State")
ggplot(data = d3) +
aes(x = factor(Year),
y = work_per_pop,
color = agency_name) +
geom_point()
ggplot(data = df3) +
aes(x = factor(Year),
y = work_per_pop,
color = agency_name) +
geom_point()
ggplot() +
aes(x = reorder(State, work_lm),
y = work_lm,
fill = factor(pop_cat)) +
geom_col(data = test)+
coord_flip() +
scale_fill_hue(h = c(0,270))
ggplot(data = df_regress)+
aes(x = factor(Year),
y = work_per_pop
) +
geom_boxplot()
test <- inner_join(df_regress, df, by = 'State')
bar_data <- df %>% group_by(pop_cat) %>% summarise(avg_lm_pop_cat = mean(work_lm))
df <- workload_regression %>% filter(p_value_work_per_pop < .10 & p_value_pop < .10 )
test <- inner_join(df_regress, df, by = 'State')
bar_data <- test %>% group_by(pop_cat) %>% summarise(avg_lm_pop_cat = mean(work_lm))
bar_data <- test %>% group_by(pop_cat) %>% summarise(avg_lm_pop_cat = mean(lm_work))
ggplot(data = df_regress)+
aes(x = factor(Year),
y = work_per_pop
) +
geom_point()+
geom_smooth()
ggplot(data = df_regress)+
aes(x = Year,
y = work_per_pop
) +
geom_point()+
geom_smooth()
ggplot(data = df_regress)+
aes(x = Year,
y = work_per_pop
) +
geom_point()+
geom_smooth(method = lm)
ggplot() +
aes(x = Year,
y = work_per_pop)+
geom_smooth(data = test)
ggplot() +
aes(x = Year,
y = work_per_pop)+
geom_smooth(data = test, aes(group = State))
ggplot() +
aes(x = Year,
y = work_per_pop)+
geom_smooth(data = test, aes(group = State), method = lm)
#graphs just the individual states regression
ggplot() +
aes(x = Year,
y = work_per_pop)+
geom_smooth(data = test, aes(group = State), method = lm) + aes(color = pop_cat)
#graphs just the individual states regression
ggplot() +
aes(x = Year,
y = work_per_pop)+
geom_smooth(data = test, aes(group = State), method = lm) + aes(color = pop_cat) + scale_color_brewer(palette = "Dark2")
#graphs just the individual states regression
ggplot() +
aes(x = Year,
y = work_per_pop)+
geom_smooth(data = test, aes(group = State), method = lm) + aes(color = factor(pop_cat)) + scale_color_brewer(palette = "Dark2")
#graphs just the individual states regression
ggplot() +
aes(x = Year,
y = work_per_pop)+
geom_smooth(data = test, aes(group = State), method = lm) + aes(color = pop_cat) +
scale_fill_hue(h = c(0,270))
workload_relative_funding_graph <-function(df){
ggplot(data= df)+
aes(x=Year,
y= work_per_dol,
label = State,
color = fund_per_pop)+
geom_text() +
labs(x = "Year",
y = "*Workload Relative Resources",
color = '**Ratio of Funding per Capita',
title = 'Visual Exploration for State Performance(Workload) Relative to Comparable States',
subtitle = 'The State names that are vertically high, worked more cases for every dollar of funding they recieved.
State names that are light in color recieved many dollars for every person in the state. ',
caption = '*Workload equal to number of cases worked divided by funding
**Dollars of funding recieved per capita'
) +
scale_color_gradient()
}
df <- workload_w_state %>% filter(pop_cat == 1)
workload_relative_funding_graph(df)
#graphs just the individual states regression
ggplot() +
aes(x = Year,
y = work_per_pop)+
geom_smooth(data = test, aes(group = State), method = lm) + aes(color = pop_cat) +
scale_fill_hue(h = c(0,270))
#graphs just the individual states regression
ggplot() +
aes(x = Year,
y = work_per_pop)+
geom_smooth(data = test, aes(group = State), method = lm) + aes(color = pop_cat) +
scale_color_hue(h = c(0,270))
#graphs just the individual states regression
ggplot() +
aes(x = Year,
y = work_per_pop)+
geom_smooth(data = test, aes(group = State), method = lm) + aes(color = factor(pop_cat)) +
scale_color_hue(h = c(0,270))
#graphs just the individual states regression
ggplot() +
aes(x = Year,
y = work_per_pop)+
geom_smooth(data = test, aes(group = State), method = lm, se = FALSE) + aes(color = factor(pop_cat)) +
scale_color_hue(h = c(0,270))
#graphs just the individual states regression
ggplot() +
aes(x = Year,
y = work_per_pop)+
geom_smooth(data = test, aes(group = State), method = lm, se = FALSE) + aes(color = factor(pop_cat)) +
scale_color_hue(h = c(0,90))
#graphs just the individual states regression
ggplot() +
aes(x = Year,
y = work_per_pop)+
geom_smooth(data = test, aes(group = State), method = lm, se = FALSE) + aes(color = factor(pop_cat)) +
scale_color_hue(h = c(0,180))
df <- workload_regression %>% filter(p_value_work_per_pop < .10 & p_value_pop < .10 )
View(df)
df <- workload_regression %>% filter(p_value_work_per_pop < .10 )
test <- inner_join(df_regress, df, by = 'State')
#graphs just the individual states regression
ggplot() +
aes(x = Year,
y = work_per_pop)+
geom_smooth(data = test, aes(group = State), method = lm, se = FALSE) + aes(color = factor(pop_cat)) +
scale_color_hue(h = c(0,180))
df <- workload_regression %>% filter(p_value_work_per_pop < .05 )
test <- inner_join(df_regress, df, by = 'State')
#graphs just the individual states regression
ggplot() +
aes(x = Year,
y = work_per_pop)+
geom_smooth(data = test, aes(group = State), method = lm, se = FALSE) + aes(color = factor(pop_cat)) +
scale_color_hue(h = c(0,180))
View(df)
df <- workload_regression %>% filter(p_value_work_per_pop < .10 )
View(df)
summary(lm(df_regress$work_per_pop ~ df_regress$Year))
df <- workload_regression %>% filter(p_value_work_per_pop < .05 )
test <- inner_join(df_regress, df, by = 'State')
test %>% filter(Year ==2018) %>% Select(State, pop_cat, lm_work_per_pop)
test %>% filter(Year ==2018) %>% select(State, pop_cat, lm_work_per_pop) %>% View()
test %>% filter(Year ==2018) %>% select(State, pop_cat, lm_pop) %>% View()
test %>% filter(Year ==2018) %>% select(State, pop_cat, lm__pop) %>% View()
#adds regression variables to the data
workload_regression <-
df_regress %>%
group_by(State) %>%
summarise(p_value_work_per_pop = p_calc(Year, work_per_pop, 8),
lm_work_per_pop = p_calc(Year,work_per_pop,  2),
p_value_pop = p_calc(Year, pop, 8),
lm_pop = p_calc(Year, pop, 2),
p_value_work = p_calc(Year, workload, 8),
lm_work = p_calc(Year,workload,  2)
)
df <- workload_regression %>% filter(p_value_work_per_pop < .05 )
test <- inner_join(df_regress, df, by = 'State')
lm_pop
df <- workload_regression %>% filter(p_value_work_per_pop < .05 )
test <- inner_join(df_regress, df, by = 'State')
test %>% filter(Year ==2018) %>% select(State, pop_cat, lm_pop) %>% View()
test %>% filter(Year ==2018) %>% select(State, pop_cat, lm_work_per_pop) %>% View()
test %>% filter(Year ==2018) %>% select(State, pop_cat, lm_pop) %>% View()
test %>% filter(Year ==2018) %>% select(State, pop_cat, lm_pop) %>% View()
test %>% filter(Year ==2018) %>% select(State, pop_cat, lm_work_per_pop) %>% View()
